<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guiding Center Dynamics in 4D · ChargedParticleDynamics.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ChargedParticleDynamics.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../charged_particle_3d/">Charged Particles in 3D</a></li><li class="is-active"><a class="tocitem" href>Guiding Center Dynamics in 4D</a><ul class="internal"><li><a class="tocitem" href="#Lagrangian-Formulation-1"><span>Lagrangian Formulation</span></a></li><li><a class="tocitem" href="#Hamiltonian-Formulation-1"><span>Hamiltonian Formulation</span></a></li><li><a class="tocitem" href="#Modules-1"><span>Modules</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Guiding Center Dynamics in 4D</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guiding Center Dynamics in 4D</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DDMGNI/ChargedParticleDynamics.jl/blob/master/docs/src/guiding_center_4d.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Guiding-Center-Dynamics-in-4D-1"><a class="docs-heading-anchor" href="#Guiding-Center-Dynamics-in-4D-1">Guiding Center Dynamics in 4D</a><a class="docs-heading-anchor-permalink" href="#Guiding-Center-Dynamics-in-4D-1" title="Permalink"></a></h1><p>Guiding centre dynamics is a reduced version of charged particle dynamics, where the motion of the particle in a strong magnetic field <span>$B$</span> is reduced to the motion of the guiding centre, that is the centre of the gyro motion of the particle about a magnetic field line. The dynamics of the guiding centre can be described in terms of only four coordinates (as compared to six for the full motion of the charged particle), the position of the guiding centre <span>$r = (x,y,z)$</span> and the parallel velocity <span>$u$</span>, where parallel refers to the direction of the magnetic field.</p><h2 id="Lagrangian-Formulation-1"><a class="docs-heading-anchor" href="#Lagrangian-Formulation-1">Lagrangian Formulation</a><a class="docs-heading-anchor-permalink" href="#Lagrangian-Formulation-1" title="Permalink"></a></h2><p>The simplest form of the guiding centre equations can be obtained from the Lagrangian</p><div>\[\begin{align*}
L &amp;= (A (r) + u b (r)) \cdot \dot{r} - H(r,u) , &amp;
H &amp;= \tfrac{1}{2} u^{2} + \mu \vert B (r) \vert ,
\end{align*}\]</div><p>where <span>$b = B / \vert B \vert$</span> is the unit vector of the magnetic field <span>$B = \nabla \times A$</span> with <span>$A$</span> the magnetic vector potential and <span>$\mu$</span> is the magnetic moment. The Euler-Lagrange equations are computed as</p><div>\[\begin{align*}
\nabla \vartheta^{T} ( r(t), u(t) ) \cdot \dot{r} (t) - \dot{\vartheta} ( r(t), u(t) ) &amp;= \nabla H ( r(t), u(t) ) , \\
b ( r(t) ) \cdot \dot{r} (t) &amp;= u (t) ,
\end{align*}\]</div><p>with <span>$\vartheta(r,u) = A (r) + u \, b (r)$</span> and the gradient <span>$\nabla$</span> denoting the derivative with respect to <span>$r$</span>.</p><h2 id="Hamiltonian-Formulation-1"><a class="docs-heading-anchor" href="#Hamiltonian-Formulation-1">Hamiltonian Formulation</a><a class="docs-heading-anchor-permalink" href="#Hamiltonian-Formulation-1" title="Permalink"></a></h2><p>Computing the time derivative of <span>$\vartheta$</span>, the Euler-Lagrange equations can be rewritten in an explicit form as</p><div>\[\begin{align*}
\dot{r} (t) &amp;= \dfrac{u (t) \, \beta (r (t))}{b (r (t)) \cdot \beta (r (t))} + \dfrac{B (r (t))}{B (r (t)) \cdot \beta (r (t))} \times \nabla H (r (t),u (t)) , \\
\dot{u} (t) &amp;= - \dfrac{\beta (r (t))}{b (r (t)) \cdot \beta (r (t))} \cdot \nabla H (r (t), u (t)) ,
\end{align*}\]</div><p>where <span>$\beta = \nabla \times \vartheta$</span>. This constitutes a noncanonical Hamiltonian system of the form</p><div>\[\dot{q} = \Omega^{-T} (q) \nabla H(q) ,\]</div><p>with <span>$q = (x,y,z,u)$</span> and the symplectic matrix <span>$\Omega$</span> given by</p><div>\[\Omega_{ij} = \dfrac{\partial \vartheta_{j}}{\partial q^{i}} - \dfrac{\partial \vartheta_{i}}{\partial q^{j}} .\]</div><h2 id="Modules-1"><a class="docs-heading-anchor" href="#Modules-1">Modules</a><a class="docs-heading-anchor-permalink" href="#Modules-1" title="Permalink"></a></h2><pre><code class="language-">Modules = [ChargedParticleDynamics.GuidingCenter4d.TokamakCartesianFastBarelyPassing,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCartesianFastBarelyTrapped,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCartesianFastDeeplyPassing,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCartesianFastDeeplyTrapped,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCartesianFastLoop,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCartesianFastSurface,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalFastBarelyPassing,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalFastBarelyTrapped,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalFastDeeplyPassing,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalFastDeeplyTrapped,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalFastLoop,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalFastSurface,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalSlowBarelyPassing,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalSlowBarelyTrapped,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalSlowDeeplyPassing,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalSlowDeeplyTrapped,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalSlowLoop,
           ChargedParticleDynamics.GuidingCenter4d.TokamakCylindricalSlowSurface,
           ChargedParticleDynamics.GuidingCenter4d.SymmetricLoop,
           ChargedParticleDynamics.GuidingCenter4d.SymmetricSurface,
           ChargedParticleDynamics.GuidingCenter4d.UniformLoop]</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../charged_particle_3d/">« Charged Particles in 3D</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 9 September 2020 10:18">Wednesday 9 September 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
